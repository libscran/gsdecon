<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gsdecon: gsdecon Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">gsdecon
   </div>
   <div id="projectbrief">C++ port of the GSDecon algorithm</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">gsdecon Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Gene set scoring with <b>GSDecon</b>.  
<a href="namespacegsdecon.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgsdecon_1_1Buffers.html">Buffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structgsdecon_1_1Buffers.html" title="Buffers for the compute() results.">Buffers</a> for the <code><a class="el" href="namespacegsdecon.html#a53b57233af73d2b0842bc1898c0a4e02">compute()</a></code> results.  <a href="structgsdecon_1_1Buffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgsdecon_1_1Options.html">Options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structgsdecon_1_1Options.html" title="Options for compute().">Options</a> for <code><a class="el" href="namespacegsdecon.html#a53b57233af73d2b0842bc1898c0a4e02">compute()</a></code>.  <a href="structgsdecon_1_1Options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgsdecon_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structgsdecon_1_1Results.html" title="Results of compute().">Results</a> of <code><a class="el" href="namespacegsdecon.html#a53b57233af73d2b0842bc1898c0a4e02">compute()</a></code>.  <a href="structgsdecon_1_1Results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8dee2458dda74541956c0d297afce186" id="r_a8dee2458dda74541956c0d297afce186"><td class="memTemplParams" colspan="2">template&lt;typename Value_ , typename Index_ , typename Block_ , typename Float_ &gt; </td></tr>
<tr class="memitem:a8dee2458dda74541956c0d297afce186"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegsdecon.html#a8dee2458dda74541956c0d297afce186">compute_blocked</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;matrix, const Block_ *block, const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;options, const <a class="el" href="structgsdecon_1_1Buffers.html">Buffers</a>&lt; Float_ &gt; &amp;output)</td></tr>
<tr class="separator:a8dee2458dda74541956c0d297afce186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190a7078286a55dab7001ef24927af74" id="r_a190a7078286a55dab7001ef24927af74"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Value_ , typename Index_ , typename Block_ &gt; </td></tr>
<tr class="memitem:a190a7078286a55dab7001ef24927af74"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structgsdecon_1_1Results.html">Results</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegsdecon.html#a190a7078286a55dab7001ef24927af74">compute_blocked</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;matrix, const Block_ *block, const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a190a7078286a55dab7001ef24927af74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b57233af73d2b0842bc1898c0a4e02" id="r_a53b57233af73d2b0842bc1898c0a4e02"><td class="memTemplParams" colspan="2">template&lt;typename Value_ , typename Index_ , typename Float_ &gt; </td></tr>
<tr class="memitem:a53b57233af73d2b0842bc1898c0a4e02"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegsdecon.html#a53b57233af73d2b0842bc1898c0a4e02">compute</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;matrix, const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;options, const <a class="el" href="structgsdecon_1_1Buffers.html">Buffers</a>&lt; Float_ &gt; &amp;output)</td></tr>
<tr class="separator:a53b57233af73d2b0842bc1898c0a4e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f95f15512b37823a4dfe21847008b4" id="r_a99f95f15512b37823a4dfe21847008b4"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Value_ , typename Index_ &gt; </td></tr>
<tr class="memitem:a99f95f15512b37823a4dfe21847008b4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structgsdecon_1_1Results.html">Results</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegsdecon.html#a99f95f15512b37823a4dfe21847008b4">compute</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;matrix, const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a99f95f15512b37823a4dfe21847008b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Gene set scoring with <b>GSDecon</b>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a99f95f15512b37823a4dfe21847008b4" name="a99f95f15512b37823a4dfe21847008b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99f95f15512b37823a4dfe21847008b4">&#9670;&#160;</a></span>compute() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Value_ , typename Index_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgsdecon_1_1Results.html">Results</a>&lt; Float_ &gt; gsdecon::compute </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacegsdecon.html#a53b57233af73d2b0842bc1898c0a4e02">compute()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the output. </td></tr>
    <tr><td class="paramname">Value_</td><td>Floating-point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>An input <b>tatami</b> matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structgsdecon_1_1Results.html" title="Results of compute().">Results</a> of the gene set score calculation. </dd></dl>

</div>
</div>
<a id="a53b57233af73d2b0842bc1898c0a4e02" name="a53b57233af73d2b0842bc1898c0a4e02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b57233af73d2b0842bc1898c0a4e02">&#9670;&#160;</a></span>compute() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Value_ , typename Index_ , typename Float_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void gsdecon::compute </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Buffers.html">Buffers</a>&lt; Float_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Per-cell scores are defined as the column means of the low-rank approximation of the input matrix. The assumption here is that the primary activity of the matrix can be quantified by the largest component of variance amongst its features. (If this was not the case, one could argue that this feature set is not well-suited to capture the biology attributed to it.) In effect, the rotation vector defines weights for all features in the set, focusing on genes that contribute to the primary activity.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Floating-point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>An input <b>tatami</b> matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Collection of buffers in which to store the scores and weights. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a190a7078286a55dab7001ef24927af74" name="a190a7078286a55dab7001ef24927af74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a190a7078286a55dab7001ef24927af74">&#9670;&#160;</a></span>compute_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Value_ , typename Index_ , typename Block_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgsdecon_1_1Results.html">Results</a>&lt; Float_ &gt; gsdecon::compute_blocked </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacegsdecon.html#a8dee2458dda74541956c0d297afce186">compute_blocked()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the output. </td></tr>
    <tr><td class="paramname">Value_</td><td>Floating-point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>An input <b>tatami</b> matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length equal to the number of columns in <code>matrix</code>. This should contain the blocking factor as 0-based block assignments (i.e., for \(N\) blocks, block identities should run from 0 to \(N-1\) with at least one entry for each block.) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structgsdecon_1_1Results.html" title="Results of compute().">Results</a> of the gene set score calculation. </dd></dl>

</div>
</div>
<a id="a8dee2458dda74541956c0d297afce186" name="a8dee2458dda74541956c0d297afce186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dee2458dda74541956c0d297afce186">&#9670;&#160;</a></span>compute_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Value_ , typename Index_ , typename Block_ , typename Float_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void gsdecon::compute_blocked </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgsdecon_1_1Buffers.html">Buffers</a>&lt; Float_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extension of the <b>GSDecon</b> method to datasets containing multiple blocks (e.g., batches, samples). We perform the PCA on the residuals generated after centering each block in <code>scran_pca::blocked_pca()</code>. Blocks can also be weighted so that they contribute equally to the rotation vector, regardless of the number of cells. Note that the purpose of the blocking is to ensure that inter-block differences do not drive the first few PCs. This process may not remove global shifts in expression between blocks, depending on the rotation vectors - the caller is responsible for per-cell scores are responsible responsibility of downstream ana</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Floating-point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">matrix</td><td>An input <b>tatami</b> matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length equal to the number of columns in <code>matrix</code>. This should contain the blocking factor as 0-based block assignments (i.e., for \(N\) blocks, block identities should run from 0 to \(N-1\) with at least one entry for each block.) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Collection of buffers in which to store the scores and weights. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
